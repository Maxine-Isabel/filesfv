{"version":3,"file":"extension.js","sources":["../src/stateMachine.ts","../src/webview/provider.ts","../src/extension.ts"],"sourcesContent":["import {\n  IntentMetadata,\n  ContextNugget,\n  ContextMap,\n  ApplicationState,\n  StateTransition,\n} from \"./types\";\n\n/**\n * Context Bridge State Machine\n * Orchestrates the 4-state MVP flow: Idle ‚Üí Trigger ‚Üí Retrieval ‚Üí Display\n */\n\n// Export function to be called from extension.ts (Node context)\n// Webview will receive data via IPC, not directly load from filesystem\nexport function getContextDatabase(db?: ContextNugget[]): ContextNugget[] {\n  // If called from extension (Node context), it can pass the loaded database\n  // If called from webview, use embedded fallback\n  return db || [];\n}\n\nexport class ContextBridgeStateMachine {\n  private currentState: ApplicationState = \"State_Idle\";\n  private sessionCache: Map<string, ContextMap> = new Map();\n  private stateHistory: StateTransition[] = [];\n\n  /**\n   * State_Trigger: Extract intent metadata from user selection\n   */\n  static extractIntentMetadata(\n    selectedText: string,\n    fileName: string,\n    fileLanguage: string,\n    lineNumber: number\n  ): IntentMetadata {\n    return {\n      selectedText,\n      fileName,\n      fileLanguage,\n      lineNumber,\n      timestamp: Date.now(),\n    };\n  }\n\n  /**\n   * State_Retrieval: Fetch context from mock database with semantic ranking\n   */\n  static retrieveContextNuggets(\n    metadata: IntentMetadata\n  ): ContextNugget[] {\n    try {\n      const database = getContextDatabase();\n\n      // Extract keywords from selected text (naive tokenization)\n      const selectedKeywords = metadata.selectedText\n        .toLowerCase()\n        .split(/\\W+/)\n        .filter((w: string) => w.length > 3);\n\n      // Semantic ranking: keyword match + recency\n      const rankedContexts = database\n        .map((ctx: ContextNugget) => {\n          // Calculate keyword density match\n          const keywordMatches = ctx.keywords.filter((kw: string) =>\n            selectedKeywords.some((sk: string) =>\n              kw.toLowerCase().includes(sk) || sk.includes(kw.toLowerCase())\n            )\n          ).length;\n\n          const matchScore = keywordMatches / Math.max(ctx.keywords.length, 1);\n\n          // Recency score (prioritize last 6 months)\n          const ctxDate = new Date(ctx.timestamp).getTime();\n          const sixMonthsAgo = Date.now() - 180 * 24 * 60 * 60 * 1000;\n          const recencyScore = ctxDate > sixMonthsAgo ? 1 : 0.5;\n\n          // Combined relevance score\n          return {\n            ...ctx,\n            calculatedScore: matchScore * 0.7 + recencyScore * 0.3,\n          };\n        })\n        .filter((ctx: ContextNugget & { calculatedScore: number }) => ctx.calculatedScore > 0)\n        .sort(\n          (a: ContextNugget & { calculatedScore: number }, b: ContextNugget & { calculatedScore: number }) =>\n            b.calculatedScore - a.calculatedScore\n        )\n        .slice(0, 3) // Top 3 results\n        .map(({ calculatedScore, ...ctx }: ContextNugget & { calculatedScore: number }) => ctx);\n\n      return rankedContexts;\n    } catch (error) {\n      console.error(\"Error retrieving context nuggets:\", error);\n      return [];\n    }\n  }\n\n  /**\n   * State_Display: Generate displayable context map\n   */\n  generateContextMap(\n    metadata: IntentMetadata,\n    nuggets: ContextNugget[]\n  ): ContextMap {\n    return {\n      metadata,\n      nuggets,\n      cachedAt: Date.now(),\n      sessionId: this.generateSessionId(),\n    };\n  }\n\n  /**\n   * Process a user selection event and emit context updates\n   */\n  processSelection(\n    selectedText: string,\n    fileName: string,\n    fileLanguage: string,\n    lineNumber: number\n  ): ContextMap | null {\n    // Transition: Idle ‚Üí Trigger\n    this.transitionState(\"State_Idle\", \"State_Trigger\", \"text-selected\");\n\n    // Extract metadata\n    const metadata = ContextBridgeStateMachine.extractIntentMetadata(\n      selectedText,\n      fileName,\n      fileLanguage,\n      lineNumber\n    );\n\n    // Transition: Trigger ‚Üí Retrieval\n    this.transitionState(\"State_Trigger\", \"State_Retrieval\", \"metadata-extracted\");\n\n    // Retrieve context\n    const nuggets = ContextBridgeStateMachine.retrieveContextNuggets(metadata);\n\n    // Transition: Retrieval ‚Üí Display\n    this.transitionState(\"State_Retrieval\", \"State_Display\", \"context-retrieved\");\n\n    // Generate context map\n    const contextMap = this.generateContextMap(metadata, nuggets);\n\n    // Cache for session persistence\n    this.sessionCache.set(contextMap.sessionId, contextMap);\n\n    // Transition back to idle\n    this.transitionState(\"State_Display\", \"State_Idle\", \"context-displayed\");\n\n    return contextMap;\n  }\n\n  /**\n   * Log a state transition for observability\n   */\n  private transitionState(from: ApplicationState, to: ApplicationState, trigger: string): void {\n    this.currentState = to;\n    this.stateHistory.push({\n      from,\n      to,\n      trigger,\n      data: { timestamp: Date.now() },\n    });\n  }\n\n  /**\n   * Generate a unique session ID\n   */\n  private generateSessionId(): string {\n    return `session-${Date.now()}-${Math.random().toString(36).substring(7)}`;\n  }\n\n  /**\n   * Get the current state\n   */\n  getState(): ApplicationState {\n    return this.currentState;\n  }\n\n  /**\n   * Get state history for debugging/metrics\n   */\n  getStateHistory(): StateTransition[] {\n    return this.stateHistory;\n  }\n\n  /**\n   * Clear session cache (optional cleanup)\n   */\n  clearSessionCache(): void {\n    this.sessionCache.clear();\n  }\n}\n","import * as vscode from 'vscode';\nimport { ContextBridgeStateMachine } from '../stateMachine';\nimport { ContextMap, WebviewMessage } from '../types';\n\nexport class ContextBridgeViewProvider implements vscode.WebviewViewProvider {\n  public static readonly viewType = 'contextBridgeSidebar';\n  private _view?: vscode.WebviewView;\n  private stateMachine: ContextBridgeStateMachine;\n\n  constructor(private readonly _extensionUri: vscode.Uri) {\n    this.stateMachine = new ContextBridgeStateMachine();\n  }\n\n  public resolveWebviewView(\n    webviewView: vscode.WebviewView,\n    _context: vscode.WebviewViewResolveContext,\n    _token: vscode.CancellationToken\n  ) {\n    this._view = webviewView;\n\n    webviewView.webview.options = {\n      enableScripts: true,\n      localResourceRoots: [this._extensionUri]\n    };\n\n    webviewView.webview.html = this.getHtmlForWebview(webviewView.webview);\n\n    webviewView.webview.onDidReceiveMessage((message: WebviewMessage) => {\n      switch (message.type) {\n        case 'navigate-link':\n          vscode.env.openExternal(vscode.Uri.parse(message.payload.url as string));\n          this.logToOutput(`[Validation] User clicked: ${message.payload.nuggetId}`);\n          break;\n        case 'log-metric':\n          this.logToOutput(`[Metric] ${message.payload.label}: ${message.payload.value}`);\n          break;\n      }\n    });\n  }\n\n  public updateContextForSelection(selectedText: string) {\n    if (this._view) {\n      // Send loading state\n      this._view.webview.postMessage({\n        type: 'loading'\n      });\n\n      // Get current editor\n      const editor = vscode.window.activeTextEditor;\n      if (!editor) return;\n\n      const fileName = editor.document.fileName;\n      const fileLanguage = editor.document.languageId;\n      const lineNumber = editor.selection.active.line + 1;\n\n      // Process through state machine\n      const contextMap = this.stateMachine.processSelection(\n        selectedText,\n        fileName,\n        fileLanguage,\n        lineNumber\n      );\n\n      if (contextMap) {\n        // Send context to webview\n        this._view.webview.postMessage({\n          type: 'update-context',\n          payload: contextMap\n        });\n\n        // Log MTTC metric\n        const mttc = Date.now() - contextMap.cachedAt;\n        this.logToOutput(`[MTTC Metric] ${mttc}ms (Target: <30000ms)`);\n      }\n    }\n  }\n\n  public updateContextForFile(fileName: string) {\n    if (this._view) {\n      // For MVP, we only process on explicit selection\n      // Future: could implement proactive surfacing based on file type\n    }\n  }\n\n  private logToOutput(message: string) {\n    const outputChannel = vscode.window.createOutputChannel('Context Bridge');\n    outputChannel.appendLine(`[${new Date().toISOString()}] ${message}`);\n  }\n\n  private getHtmlForWebview(webview: vscode.Webview): string {\n    const { join } = require('path');\n    const webviewMainPath = join(this._extensionUri.fsPath, 'dist', 'webview.js');\n    const mainUri = webview.asWebviewUri(vscode.Uri.file(webviewMainPath));\n\n    return `<!DOCTYPE html>\n      <html lang=\"en\">\n      <head>\n        <meta charset=\"UTF-8\" />\n        <meta name=\"viewport\" content=\"width=device-width, initial-scale=1.0\" />\n        <title>Context Bridge</title>\n        <style>\n          * {\n            margin: 0;\n            padding: 0;\n            box-sizing: border-box;\n          }\n\n          body {\n            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', 'Roboto', sans-serif;\n            background: var(--vscode-editor-background);\n            color: var(--vscode-editor-foreground);\n            padding: 12px;\n            font-size: 13px;\n            line-height: 1.6;\n          }\n\n          #root {\n            height: 100vh;\n            overflow: hidden;\n          }\n\n          .container {\n            display: flex;\n            flex-direction: column;\n            gap: 12px;\n            height: 100%;\n          }\n\n          .header {\n            display: flex;\n            align-items: center;\n            gap: 8px;\n            margin-bottom: 8px;\n            flex-shrink: 0;\n          }\n\n          .header-icon {\n            font-size: 18px;\n          }\n\n          .header-title {\n            font-weight: 600;\n            font-size: 14px;\n            color: var(--vscode-foreground);\n          }\n\n          .content {\n            flex: 1;\n            overflow-y: auto;\n          }\n\n          .loading-state {\n            display: flex;\n            flex-direction: column;\n            align-items: center;\n            justify-content: center;\n            height: 100%;\n            color: var(--vscode-descriptionForeground);\n          }\n\n          .spinner {\n            width: 24px;\n            height: 24px;\n            border: 2px solid var(--vscode-editor-lineHighlightBorder);\n            border-top-color: var(--vscode-textLink-foreground);\n            border-radius: 50%;\n            animation: spin 0.8s linear infinite;\n            margin-bottom: 12px;\n          }\n\n          @keyframes spin {\n            to { transform: rotate(360deg); }\n          }\n\n          .nugget-card {\n            background: var(--vscode-editor-inlineValue-background);\n            border: 1px solid var(--vscode-editor-lineHighlightBorder);\n            border-radius: 4px;\n            padding: 12px;\n            margin-bottom: 12px;\n            transition: all 0.2s ease;\n          }\n\n          .nugget-card:hover {\n            border-color: var(--vscode-focusBorder);\n            background: var(--vscode-editor-hoverHighlightBackground);\n          }\n\n          .nugget-title {\n            font-weight: 600;\n            font-size: 13px;\n            margin-bottom: 8px;\n            color: var(--vscode-textLink-foreground);\n          }\n\n          .nugget-content {\n            font-size: 12px;\n            line-height: 1.5;\n            margin-bottom: 10px;\n            color: var(--vscode-editor-foreground);\n            padding: 8px;\n            background: var(--vscode-editor-background);\n            border-radius: 3px;\n            border-left: 3px solid var(--vscode-textLink-foreground);\n          }\n\n          .nugget-meta {\n            display: flex;\n            justify-content: space-between;\n            align-items: center;\n            font-size: 11px;\n            color: var(--vscode-descriptionForeground);\n            margin-bottom: 8px;\n            padding: 4px 0;\n            border-top: 1px solid var(--vscode-editor-lineHighlightBorder);\n            border-bottom: 1px solid var(--vscode-editor-lineHighlightBorder);\n            padding-top: 8px;\n            padding-bottom: 8px;\n          }\n\n          .nugget-source {\n            display: inline-block;\n            background: var(--vscode-badge-background);\n            color: var(--vscode-badge-foreground);\n            padding: 2px 6px;\n            border-radius: 3px;\n            font-weight: 500;\n          }\n\n          .nugget-relevance {\n            background: var(--vscode-diffEditor-insertedLineBackground);\n            padding: 2px 6px;\n            border-radius: 3px;\n            font-weight: 600;\n          }\n\n          .keywords {\n            display: flex;\n            flex-wrap: wrap;\n            gap: 4px;\n            margin-bottom: 8px;\n          }\n\n          .keyword-tag {\n            font-size: 11px;\n            background: var(--vscode-editor-inlineValue-background);\n            color: var(--vscode-editor-inlineValue-foreground);\n            padding: 2px 4px;\n            border-radius: 2px;\n            border: 1px solid var(--vscode-editor-lineHighlightBorder);\n          }\n\n          .nugget-button {\n            width: 100%;\n            padding: 8px 12px;\n            background: var(--vscode-textLink-foreground);\n            color: var(--vscode-editor-background);\n            border: none;\n            border-radius: 4px;\n            font-size: 12px;\n            font-weight: 600;\n            cursor: pointer;\n            transition: opacity 0.2s;\n          }\n\n          .nugget-button:hover {\n            opacity: 0.8;\n          }\n\n          .footer {\n            flex-shrink: 0;\n            border-top: 1px solid var(--vscode-editor-lineHighlightBorder);\n            padding-top: 8px;\n            font-size: 11px;\n            color: var(--vscode-descriptionForeground);\n            text-align: center;\n          }\n        </style>\n      </head>\n      <body>\n        <div class=\"container\">\n          <div class=\"header\">\n            <div class=\"header-icon\">üîó</div>\n            <div class=\"header-title\">Context Bridge</div>\n          </div>\n          <div id=\"root\" class=\"content\"></div>\n          <div class=\"footer\">MTTC Target: &lt;30s | Powered by Context Bridge</div>\n        </div>\n\n        <script>\n          const vscode = acquireVsCodeApi();\n\n          window.addEventListener('message', (event) => {\n            const message = event.data;\n            if (message.type === 'loading') {\n              renderLoading();\n            } else if (message.type === 'update-context') {\n              renderContext(message.payload);\n            } else if (message.type === 'clear') {\n              clearContext();\n            }\n          });\n\n          function renderLoading() {\n            const root = document.getElementById('root');\n            root.innerHTML = \\`\n              <div class=\"loading-state\">\n                <div class=\"spinner\"></div>\n                <p>Searching for context...</p>\n              </div>\n            \\`;\n          }\n\n          function renderContext(contextMap) {\n            const root = document.getElementById('root');\n            if (!contextMap || !contextMap.nuggets || contextMap.nuggets.length === 0) {\n              root.innerHTML = '<div style=\"padding: 20px; text-align: center; color: var(--vscode-descriptionForeground);\">üìù Highlight code to see related context</div>';\n              return;\n            }\n\n            const nuggetsHtml = contextMap.nuggets.map((nugget, idx) => \\`\n              <div class=\"nugget-card\">\n                <div class=\"nugget-title\">\\${idx + 1}. \\${nugget.source} - \\${nugget.title || 'Context'}</div>\n                <div class=\"nugget-content\">\\${nugget.content}</div>\n                <div class=\"nugget-meta\">\n                  <span class=\"nugget-source\">\\${nugget.source}</span>\n                  <span class=\"nugget-relevance\">\\${(nugget.relevanceScore * 100).toFixed(0)}% relevant</span>\n                </div>\n                <div class=\"keywords\">\n                  \\${nugget.keywords.slice(0, 3).map(kw => \\`<span class=\"keyword-tag\">#\\${kw}</span>\\`).join('')}\n                </div>\n                <button class=\"nugget-button\" onclick=\"openContext('\\${nugget.id}', '\\${nugget.source}', '\\${nugget.url}')\">\n                  View Full Context ‚Üí\n                </button>\n              </div>\n            \\`).join('');\n\n            root.innerHTML = nuggetsHtml;\n          }\n\n          function openContext(nuggetId, source, url) {\n            vscode.postMessage({\n              type: 'navigate-link',\n              payload: {\n                nuggetId: nuggetId,\n                source: source,\n                url: url,\n                timestamp: Date.now()\n              }\n            });\n          }\n\n          function clearContext() {\n            document.getElementById('root').innerHTML = '';\n          }\n        </script>\n      </body>\n      </html>`;\n  }\n}\n","import * as vscode from 'vscode';\nimport { ContextBridgeViewProvider } from './webview/provider';\n\n/**\n * Extension Activation\n * Initializes the Context Bridge extension with sidebar provider and event listeners\n */\nexport function activate(context: vscode.ExtensionContext) {\n  const provider = new ContextBridgeViewProvider(context.extensionUri);\n\n  // Register the webview view provider\n  context.subscriptions.push(\n    vscode.window.registerWebviewViewProvider(\n      'contextBridgeSidebar',\n      provider,\n      { webviewOptions: { retainContextWhenHidden: true } }\n    )\n  );\n\n  // Listen for text selection events (State_Trigger)\n  context.subscriptions.push(\n    vscode.window.onDidChangeTextEditorSelection((event) => {\n      const selection = event.textEditor.document.getText(event.selections[0]);\n      if (selection.trim().length > 0) {\n        provider.updateContextForSelection(selection);\n      }\n    })\n  );\n\n  // Listen for active editor changes (State_Idle monitoring)\n  context.subscriptions.push(\n    vscode.window.onDidChangeActiveTextEditor((editor) => {\n      if (editor) {\n        const fileName = editor.document.fileName;\n        provider.updateContextForFile(fileName);\n      }\n    })\n  );\n\n  vscode.window.showInformationMessage('Context Bridge activated! Highlight code to see related context.');\n}\n\n/**\n * Extension Deactivation\n */\nexport function deactivate() {\n  return undefined;\n}\n"],"names":[],"mappings":"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E,WAAO;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,EAwQT;AACF;AAlWE,cADW,2BACY,YAAW;ACE7B,SAAS,SAAS,SAAkC;AACzD,QAAM,WAAW,IAAI,0BAA0B,QAAQ,YAAY;AAGnE,UAAQ,cAAc;AAAA,IACpB,OAAO,OAAO;AAAA,MACZ;AAAA,MACA;AAAA,MACA,EAAE,gBAAgB,EAAE,yBAAyB,OAAK;AAAA,IAAE;AAAA,EACtD;AAIF,UAAQ,cAAc;AAAA,IACpB,OAAO,OAAO,+BAA+B,CAAC,UAAU;AACtD,YAAM,YAAY,MAAM,WAAW,SAAS,QAAQ,MAAM,WAAW,CAAC,CAAC;AACvE,UAAI,UAAU,OAAO,SAAS,GAAG;AAC/B,iBAAS,0BAA0B,SAAS;AAAA,MAC9C;AAAA,IACF,CAAC;AAAA,EAAA;AAIH,UAAQ,cAAc;AAAA,IACpB,OAAO,OAAO,4BAA4B,CAAC,WAAW;AACpD,UAAI,QAAQ;AACV,cAAM,WAAW,OAAO,SAAS;AACjC,iBAAS,qBAAqB,QAAQ;AAAA,MACxC;AAAA,IACF,CAAC;AAAA,EAAA;AAGH,SAAO,OAAO,uBAAuB,kEAAkE;AACzG;AAKO,SAAS,aAAa;AAC3B,SAAO;AACT;"}